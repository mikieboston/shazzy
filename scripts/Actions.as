/**   September 2007   Slideshow 6 - XML   Copyright © 2007 by Andrei Potorac   All rights reserved.*/stop();Stage.showMenu = false;Stage.scaleMode = "noScale";this._lockroot = true;/********************General settings********************/var stagew:Number = 852;var stageh:Number = 578;var nrFrames:Number = 30;//var maskwSize:Number = 20;var maskhSize:Number = 20;///**Movieclip loader*/var listnerGallery:Object = new Object();listnerGallery.onLoadProgress = function(mc:MovieClip, bytesLoaded:Number, bytesTotal:Number):Void {	var pct:Number = bytesLoaded / bytesTotal * 100;	if (pct > 5)	{		_root.mcLoader._visible = true;	}};listnerGallery.onLoadInit = function(mc:MovieClip){	if (_root.firstImage == true)	{		_root.firstImage = false;		_root.isPaused = false;	}	_root.mcLoader._visible = false;	_root.displayImage();};var objGallery:MovieClipLoader = new MovieClipLoader();objGallery.addListener(listnerGallery);/********************VARIABLES********************/var randomArray:Array = new Array();var masterArray:Array = new Array();var numePoze:Array = new Array();var linkArray:Array = new Array();var targetArray:Array = new Array();var textArray:Array = new Array();//var nrPoze:Number;var nowLoading:Boolean = true;var firstImage:Boolean = true;//var timp:Number = 5;var contPoze:Number = 1;var k:Number = 0;var prevValue:Number = 0;var maskDone:Boolean = false;var rand:Boolean = false;var slideShow:Boolean = true;var borderC:String;var movement:Boolean = false;_root.mcBut.but.enabled = false;var dir:String;_root.loader._visible = false;_root.loader._x = (_root.stagew - _root.loader._width) / 2;_root.loader._y = (_root.stageh - _root.loader._height) / 2;_root.cpanel._visible = false;_root.mcBack._alpha = 0;_root.mcLoader._visible = false;///********************Parse XML********************/var trackXML:XML = new XML();trackXML.ignoreWhite = true;_root.trackXML.load(_root.xmlfile);//trackXML.onLoad = function():Void {	var currentNode:XMLNode = this.firstChild.firstChild;	var i:Number = 0;	for (var childNode = currentNode; childNode != null; childNode = childNode.nextSibling, i++)	{		var j:Number = 0;		masterArray[i] = new Array();		j++;		for (var stringNode = childNode.firstChild; stringNode != null; stringNode = stringNode.nextSibling, j++)		{			masterArray[i][j] = stringNode.firstChild.nodeValue;			//trace("masterArray["+i+"]["+j+"]"+masterArray[i][j]);			if (i == 0)			{				_root.numePoze[j] = stringNode.attributes.image;				_root.linkArray[j] = stringNode.attributes.link;				_root.targetArray[j] = stringNode.attributes.target;				_root.textArray[j] = masterArray[i][j];			}		}	}	_root.nrPoze = numePoze.length - 1;	if (masterArray[1][1] != "" && masterArray[1][1] != undefined)	{		_root.timp = int(masterArray[1][1]);	}	if (masterArray[1][2] != "" && masterArray[1][2] != undefined)	{		_root.speed = int(masterArray[1][2]);	}	if (masterArray[1][3] == "true")	{		_root.rand = true;	}	//                                                                                                                                                              	_root.maskImages._height = stageh;	_root.maskImages._width = stagew;	//	_root.mcBut._yscale = 10 * (stageh);	_root.mcBut._xscale = 10 * stagew;	//	_root.mcTxt.setColor(_root.masterArray[1][8]);	//	if (_root.masterArray[1][4] != undefined)	{		_root.createEmptyMovieClip("chenarMc", 1);		_root.chenarMc.outline(0, 0, stagew, stageh, _root.masterArray[1][4]);	}	//                                                                                                                                                                                                    	_root.effect = masterArray[1][5];	//                                                  	_root.randomArray.randoMix(_root.nrPoze);	//trace(_root.randomArray);	//                                                        	_root.dir = _root.masterArray[1][7];	//	_root.loadImages(1);};////************************************************************//// LOAD IMAGES//************************************************************//function loadImages(val:Number):Void{	if (val)	{		_root.k = val;	}	else	{		_root.k++;		if (_root.k > _root.nrPoze)		{			_root.k = 1;		}	}	_root.prevValue = _root.k;	if (_root.rand == true)	{		//trace("k = "+_root.k);		_root.randval = _root.randomArray[_root.k - 1];		_root.prevValue = _root.randval;	}	//                                                                                                                  	_root.par = _root.contPoze % 2;	_root.contPoze++;	if (_root.par == 0)	{		_root.par = 2;	}	_root.nowLoading = true;	if (_root.effect != "fade")	{		_root.imageControl["maskDots" + _root.par].gotoAndStop(2);	}	_root.imageControl.image1.swapDepths(_root.imageControl.image2);	//	_root.imageControl["image" + _root.par]._alpha = 0;	if (_root.rand == true)	{		_root.objGallery.loadClip(_root.numePoze[_root.randval], _root.imageControl["image" + _root.par]);	}	else	{		_root.objGallery.loadClip(_root.numePoze[_root.k], _root.imageControl["image" + _root.par]);	}}//************************************************************////  contor//************************************************************//function countTime(mc:MovieClip):Void{	var contor = 0;	mc.onEnterFrame = function()	{		if (_root.effect == "fade")		{			if (_root.slideShow == true && _root.nowLoading == false)			{				contor++;				if (contor / _root.nrFrames == _root.timp)				{					_root.loadImages();					delete this.onEnterFrame();				}			}		}		else		{			if (_root.slideShow == true && _root.maskDone == true)			{				contor++;				if (contor / _root.nrFrames == _root.timp)				{					_root.loadImages();					_root.maskDone = false;					delete this.onEnterFrame();				}			}		}	};}//************************************************************////  EFFECT: "FADE IN" AND "FADE OUT" IMAGES//************************************************************//var cnt:Number = 0;fadeImages = function (dir:String, addInteger:Number, mc:MovieClip):Void{	this = mc;	delete this.onEnterFrame;	this.step = (dir == "in") ? 0 : 100;	this.onEnterFrame = function()	{		this.step = (dir == "in") ? this.step + addInteger : this.step - addInteger;		this._alpha = this.step;		if (((dir == "in") && this._alpha >= 100) || ((dir == "out") && this._alpha <= 0))		{			//			_root.cnt++;			if (_root.cnt == 5)			{				_root.nowLoading = false;				_root.cnt = 0;				delete this.onEnterFrame;			}		}	};};//************************************************************//// CHECK IF THE IMAGE IS LOADED//************************************************************//function displayImage():Void{	id = _root.par;	//	if (_root.nrPoze > 1 && _root.masterArray[1][6] == "true")	{		_root.cpanel._visible = true;	}	_root.loader._visible = false;	if (_root.imageControl["image" + id]._width != 0)	{		//		newVal = _root.k;		if (_root.rand == true)		{			newVal = _root.randval;		}		if (_root.linkArray[newVal] != "" && _root.linkArray[newVal] != undefined)		{			_root.mcBut.but.enabled = true;			_root.mcBut.but.onRelease = function()			{				getURL(_root.linkArray[newVal], _root.targetArray[newVal]);			};		}		else		{			_root.mcBut.but.enabled = false;		}		//		if (_root.textArray[newVal] == "" || _root.textArray[newVal] == undefined)		{			_root.mcBack._visible = false;			_root.mcTxt.txt.htmlText = "";		}		else		{			_root.mcBack._visible = true;			_root.mcTxt.txt.htmlText = _root.textArray[newVal];		}		//                                                                            		clearInterval(_root.my_intervalA);		_root.mcBack._alpha = 100;		//		if (_root.effect == "scroll")		{			delete _root.imageControl.image2.onEnterFrame();			delete _root.imageControl.image1.onEnterFrame();			switch (_root.dir)			{			case "up" :				_root.imageControl["image" + id]._y = _root.stageh;				_root.imageControl["image" + id].elastic({_y:0}, _root.speed, _root.countTime());				break;			case "down" :				_root.imageControl["image" + id]._y = 0 - _root.imageControl["image" + id]._height;				_root.imageControl["image" + id].elastic({_y:0}, _root.speed, _root.countTime());				break;			case "left" :				_root.imageControl["image" + id]._x = _root.stagew;				_root.imageControl["image" + id].elastic({_x:0}, _root.speed, _root.countTime());				break;			case "right" :				_root.imageControl["image" + id]._x = 0 - _root.imageControl["image" + id]._width;				_root.imageControl["image" + id].elastic({_x:0}, _root.speed, _root.countTime());				break;			}			_root.imageControl["image" + id]._alpha = 100;			//		}		else if (_root.effect == "fade")		{			delete _root.imageControl.image2.onEnterFrame();			delete _root.imageControl.image1.onEnterFrame();			//			fadeImages("in", _root.speed, _root.imageControl["image" + id]);		}		else		{			_root.imageControl["image" + id].setMask(_root.imageControl["maskDots" + id]);			_root.imageControl["maskDots" + id].gotoAndPlay(2);			_root.imageControl["image" + id]._alpha = 100;		}		//		if (_root.nrPoze > 1 && _root.timp != 0)		{			_root.countTime(_root.imageControl);		}	}}////************************************************************////  CONTROL PANEL//************************************************************//function forwardSlide():Void{	if (_root.effect == "fade")	{		if (_root.nowLoading == false)		{			clearInterval(_root.my_intervalA);			delete _root.imageControl.image2.onEnterFrame();			delete _root.imageControl.image1.onEnterFrame();			var val = _root.k + 1;			if (val > _root.nrPoze)			{				val = 1;			}			_root.loadImages(val);		}	}	else	{		if (_root.maskDone == true)		{			var val = _root.k + 1;			if (val > _root.nrPoze)			{				val = 1;			}			_root.loadImages(val);			_root.maskDone = false;		}	}}function backSlide():Void{	if (_root.effect == "fade")	{		if (_root.nowLoading == false)		{			clearInterval(_root.my_intervalA);			delete _root.imageControl.image2.onEnterFrame();			delete _root.imageControl.image1.onEnterFrame();			var val = _root.k - 1;			if (val < 1)			{				val = _root.nrPoze;			}			_root.loadImages(val);		}	}	else	{		if (_root.maskDone == true)		{			var val = _root.k - 1;			if (val < 1)			{				val = _root.nrPoze;			}			_root.loadImages(val);			_root.maskDone = false;		}	}}function pauseSlide():Void{	if (_root.effect == "fade")	{		if (_root.nowLoading == false)		{			_root.frameNumber = _root.cpanel.pBut._currentframe % 2 + 1;			_root.cpanel.pBut.gotoAndStop(_root.frameNumber);			delete _root.imageControl.image2.onEnterFrame();			delete _root.imageControl.image1.onEnterFrame();			//			_root.slideShow = !_root.slideShow;			if (_root.slideShow == true)			{				var val = _root.k + 1;				if (val > _root.nrPoze)				{					val = 1;				}				_root.loadImages(val);			}		}	}	else	{		if (_root.maskDone == true)		{			_root.frameNumber = _root.cpanel.pBut._currentframe % 2 + 1;			_root.cpanel.pBut.gotoAndStop(_root.frameNumber);			//			_root.slideShow = !_root.slideShow;			if (_root.slideShow == true)			{				var val = _root.k + 1;				if (val > _root.nrPoze)				{					val = 1;				}				_root.loadImages(val);				_root.maskDone = false;			}		}	}}cpanel.bBut.but.onRelease = function():Void {	backSlide();};cpanel.fBut.but.onRelease = function():Void {	forwardSlide();};